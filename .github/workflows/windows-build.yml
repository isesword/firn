# name: windows-build

# on:
#   push:
#     branches: [main]
#   pull_request:
#     branches: [main]
#   workflow_dispatch:

# jobs:
#   build-windows:
#     runs-on: windows-latest
#     env:
#       CGO_ENABLED: 1
#       CGO_LDFLAGS: -w
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v4
#         with:
#           fetch-depth: 0

#       - name: Set up Go
#         uses: actions/setup-go@v5
#         with:
#           go-version-file: go.mod
#           cache: true

#       - name: Set up Rust
#         uses: dtolnay/rust-toolchain@stable
#         with:
#           targets: x86_64-pc-windows-msvc

#       - name: Cache cargo registry
#         uses: actions/cache@v4
#         with:
#           path: |
#             ~/.cargo/registry
#             ~/.cargo/git
#           key: ${{ runner.os }}-cargo-${{ hashFiles('rust/Cargo.lock') }}
#           restore-keys: |
#             ${{ runner.os }}-cargo-

#       - name: Cache cargo target
#         uses: actions/cache@v4
#         with:
#           path: rust/target
#           key: ${{ runner.os }}-cargo-target-${{ hashFiles('rust/Cargo.lock') }}
#           restore-keys: |
#             ${{ runner.os }}-cargo-target-

#       - name: Prepare lib directory
#         run: mkdir -p lib
#         shell: bash

#       - name: Build Rust static library
#         run: ./scripts/build_rust.sh
#         shell: bash

#       # - name: Run Go tests (polars)
#       #   run: go test ./polars -v
#       #   shell: bash

#       - name: Package Windows artifacts
#         run: |
#           tar -czf firn-windows-amd64.tar.gz \
#             lib/firn_windows_amd64.lib \
#             polars/firn.h \
#             README.md
#         shell: bash

#       - name: Upload Windows artifact
#         uses: actions/upload-artifact@v4
#         with:
#           name: firn-windows-amd64
#           path: firn-windows-amd64.tar.gz
